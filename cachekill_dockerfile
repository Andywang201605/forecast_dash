# -*- mode:sh -*-
# Dockerfile structure: put things at the top that won't change often.
#
# "Docker doesn't rebuild layers it's already built, and it caches the
# Dockerfile line by line. Try changing one character of a Dockerfile you've
# already built, and then rebuild. You'll notice that each step above that line
# will be recognized as already been built, but the line you changed (and each
# line following) will be rebuilt."
#   (from https://hackernoon.com/tips-to-reduce-docker-image-sizes-876095da3b34)
#
FROM python:3

# Install cron and dependencies
RUN apt-get update && apt-get -y install cron

# Install and set timezone
RUN apt-get -y install tzdata &&\
    cp /usr/share/zoneinfo/Australia/Sydney /etc/localtime &&\
    echo "Australia/Sydney" > /etc/timezone

# Add crontab file in the cron directory
ADD killer-cron /etc/cron.d/updater-cron

# Give execution rights on the cron job
RUN chmod 0644 /etc/cron.d/updater-cron
# Apply cron job
RUN crontab /etc/cron.d/updater-cron

# Run the command on container startup
CMD ["cron", "-f"]
